function Onload(){site.onload.length!==0&&eval(site.onload.join(";"));PrepareStatusDisplay();site.electionGuid&&connectToElectionHub();showMenu(site.electionState,!0);CheckTimeOffset();AttachHelp();PrepareMainMenu();HighlightActiveLink();AttachHandlers();PrepareTopLocationAndTellers();PrepareQTips();showElectionInfo()}function showElectionInfo(){$(".passcodeOkay").toggle(site.passcode!="");$(".passcodeLocked").toggle(site.passcode=="");$(".passcode").on("click",function(){location.href=site.rootUrl+"After/monitor"})}function updatePasscodeDisplay(n,t){typeof t=="string"&&(site.passcode=t,$(".passcodeText").text(site.passcode));n===null&&(n=!1);$(".passcodeOkay").toggle(n&&!!site.passcode);$(".passcodeLocked").toggle(!n||!site.passcode)}function HighlightActiveLink(){var n=location.href;$("#quickLinkItems a").each(function(){var i=n==this.href,t=$(this);i?t.addClass("Active"):t.removeClass("Active")})}function clearElectionRelatedStorageItems(){for(var n in localStorage)localStorage.hasOwnProperty(n)&&(n.substr(0,5)==="name_"?localStorage.removeItem(n):n==="ActiveUploadRowId"&&localStorage.removeItem(n));localStorage.removeItem("locationKnown")}function logoffSignalR(){console.log("closing signalr");$.connection.hub.stop()}function PrepareQTips(n){if(!n){setTimeout(function(){PrepareQTips(!0)},500);return}site.qTips.push({selector:"#qTipQuickLinks",title:"Relevant Pages",text:"Shows the pages relevant to the current state of the election. All pages are still available by hovering over other State buttons."});site.qTips.push({selector:"#qTipElectionStatus",title:"Election State",text:"An election proceeds through various states. The head teller should actively change the state by clicking these buttons as appropriate."});site.qTips.push({selector:"#qTipTeller",title:"Tellers",text:"Please ensure that your name shows here when using this computer. If your name is not in the list, add it! This can help later when reviewing ballots."});site.qTips.push({selector:"#qTipTopLocation",title:"Location",text:"Please ensure that this is your location!"});site.qTips.push({selector:"#qTipPasscode",title:"Election Open for Tellers",text:"Tellers can join this election using the access code&nbsp; <b class=passcodeText><\/b> &nbsp;on the Home Page.",events:{render:function(){$(".passcodeText").text(site.passcode)}}});site.qTips.push({selector:"#qTipPasscodeLocked",title:"Election Closed",text:"This election is not visible on the home page."});$("body").hasClass("AuthKnown")?site.qTips.push({selector:"#qTipFinalized",title:"Finalized State",text:'Set the election to this state using the buttons on the Analyze page. When "Finalized", no further inputs or changes are permitted.'}):site.qTips.push({selector:"#qTipFinalized",title:"Finalized State",text:'Set by the head teller. When "Finalized", no further inputs or changes are permitted.'});$("#qTipReg1").length&&(site.qTips.push({selector:"#qTipReg1",title:"Login ID",text:"This is your personal login ID, and can be relatively short.  You will use it when logging in each time you use TallyJ.  It will not be seen in many places, mostly just by administrators of the TallyJ system."}),site.qTips.push({selector:"#qTipReg2",title:"Email Address",text:"Please use a valid address where you can be notified when there is important news regarding TallyJ. It will not be given to anyone else or used for other purposes."}),site.qTips.push({selector:"#qTipReg3",title:"Password",text:"Needs to be at least 6 characters long. It will be encrypted when stored, so cannot be viewed by anyone."}));ActivateTips()}function ActivateTips(n){var t={position:{my:"bottom left",at:"top center",viewport:!0},content:{text:"",title:{text:""}},style:{classes:"qtip-tallyj qtip-rounded qtip-shadow"}};$(".qTip").qtip(t);$.each(site.qTips,function(){if(n||!1||!$(this).data("done")){var i=$.extend(!0,{},t,this);this.text&&(i.content.text=this.text,this.title&&(i.content.title.text=this.title));$(this).data("done",!0);$(this.selector).qtip(i)}})}function AttachHandlers(){site.onbroadcast(site.broadcastCode.electionStatusChanged,updateElectionStatus);var n=null,t=function(){$("#quickLinkItems span.HighlightMenu").removeClass("HighlightMenu");$("#quickLinkItems span.DropDown").removeClass("DropDown");$(".QuickDash").fadeOut("fast")};$("body.AuthKnown #electionState span.Finalized").on("click",function(){$("#qTipElectionStatus").trigger("click")});$("body.AuthKnown #electionState span.state").not(".General, .Finalized").on("click",function(){var t=$(this),n={state:t.data("state")};n.state!==site.electionState&&(ShowStatusDisplay("Saving..."),CallAjaxHandler(site.rootUrl+"Elections/UpdateElectionStatus",n,function(n){if(n.Message){ShowStatusFailed(n.Message);return}ResetStatusDisplay();site.broadcast(site.broadcastCode.electionStatusChanged,n)}))});$("#electionState").on("mouseover","#AllPages",function(){clearTimeout(n);t();showAllPages(this)}).on("mouseout","#AllPages",function(){clearTimeout(n);n=setTimeout(t,200)});$("#electionState").on("mouseover","span.state",function(i){clearTimeout(n);var r=$(i.target),f=r.data("state"),u=$("#menu"+f);if(t(),u.is(":visible")){u.addClass("HighlightMenu");n=setTimeout(t,700);return}u.addClass("DropDown").css({left:getFullOffsetLeft(r)+"px",top:r.offset().top+r.height()-2+"px"})}).on("mouseout","span.state",function(){clearTimeout(n);n=setTimeout(t,200)});$("body").on("mouseover",".DropDown,.QuickDash",function(){clearTimeout(n)}).on("mouseout",".DropDown,.QuickDash",function(){clearTimeout(n);n=setTimeout(t,200)});$("body").on("click",'a[href="/Account/Logoff"]',function(){logoffSignalR()})}function getFullOffsetLeft(n){return n.hasClass("content-wrapper")?0-n.offset().left:n.offset().left+getFullOffsetLeft(n.offsetParent())}function updateElectionStatus(n,t){site.electionState=t.StateName;showMenu(t.StateName,!0)}function showAllPages(n){var t=$(n),i=$("span.QuickDash");i.css({left:getFullOffsetLeft(t)-15,right:"auto",top:t.offset().top+t.height()-2}).show();$(".ElectionState .General").addClass("GeneralActive");setTimeout(function(){$(document).on("click",quickDashCloser)},0)}function showMenu(n,t){var i=$("#electionState"),r;$("#quickLinkItems span:visible").addClass("Hidden").removeClass("DropDown");$("#menu"+n).removeClass("Hidden").removeClass("DropDown");r=i.find("span.state[data-state={0}]".filledWith(n));$("#qmenuTitle").text(r.text()).removeClass().addClass(n);$("#QuickLinks2").removeClass().addClass(n);site.menuShowingDefault=t;site.electionState=n;i.data("state",n);i.find("span.state").removeClass("Active_True Active_Temp").addClass("Active_False");r.removeClass("Active_False Active_Temp").addClass("Active_True")}function HoverQuickLink(){}function CheckTimeOffset(){if(!site.timeOffsetKnown){var n=new Date,t={now:n.getTime()-n.getTimezoneOffset()*6e4};CallAjaxHandler(GetRootUrl()+"misc/GetTimeOffset",t,function(n){site.timeOffset=n.timeOffset;site.timeOffsetKnown=!0})}}function PrepareTopLocationAndTellers(){$("#ddlTopLocation").change(function(){ShowStatusDisplay("Saving...");var n=$(this),t={id:n.val()};if(n.find('option[value="-1"]').remove(),t.id=="-2"){site.broadcast(site.broadcastCode.locationChanged);setTopInfo();return}CallAjaxHandler(GetRootUrl()+"Dashboard/ChooseLocation",t,function(){ShowStatusSuccess("Saved");site.broadcast(site.broadcastCode.locationChanged);setTopInfo()})});$(".TopTeller").change(function(){var n=$(this),i=+n.val(),t={num:this.id.substr(-1),teller:i};if(i==-1&&(t.newName=prompt("Please type name to add:"),!t.newName)){n.val(n.data("current"));ResetStatusDisplay();return}ShowStatusDisplay("Saving...");CallAjaxHandler(GetRootUrl()+"Dashboard/ChooseTeller",t,function(t){if(ShowStatusSuccess("Saved"),n.data("current",n.val()),t.TellerList){n.html(t.TellerList);var i=$(".TopTeller").not(n),r=i.val();i.html(t.TellerList);i.val(r)}setTopInfo()})}).each(function(){var n=$(this);n.data("current",n.val())});setTopInfo()}function PrepareMainMenu(){}function AttachHelp(){var t=$(".PullInstructionsHandle"),n;t.each(function(n,t){var i=$(t),r;i[0].accessKey="I";r=i.text()||"Instructions & Tips";i.html("<span class=IfOpen>Hide<\/span> <span>{0}<\/span>".filledWith(r))});n=function(n,t,i){var r=n.next(),u;i?r.toggle(t):t?r.slideDown({easing:"linear",duration:"fast"}):r.slideUp({easing:"linear",duration:"fast"});n.toggleClass("Closed",!t);u="HidePI_"+location.pathname+n[0].id;t?SetInStorage(u,t?null:"hide"):SetInStorage(u,"hide")};$(document).on("click",".PullInstructionsHandle",function(t){var i=$(t.currentTarget);n(i,!i.next().is(":visible"),!1)});$(".PullInstructionsHandle").each(function(t,i){var r=$(i),u=t+1;i.id="pi"+u;n(r,GetFromStorage("HidePI_"+location.pathname+i.id,"show")!="hide",!0)})}function HasErrors(n){return/\<h2\>Object moved to/.test(n)?(top.location.href=new RegExp('href="(.*)">').exec(n)[1],!0):/\<\!DOCTYPE html\>/.test(n)?(top.location.reload(),!0):/Internal Server Error/.test(n)?(ShowStatusFailed("Server Error."),!0):/Anonymous access denied/.test(n)?(top.location.reload(),!0):/Server Error/.test(n)?(ShowStatusFailed(n.replace("/*","").replace("*/","")),!0):/^Exception:/.test(n)?(ShowStatusFailed("Server Error: "+n.substr(0,60)+"..."),console.log(n),!0):/Error\:/.test(n)?(ShowStatusFailed("An error occurred on the server. The Technical Support Team has been provided with the error details."),!0):!1}function GetResource(n){return MyResources[n]}function ActivateHeartbeat(n,t){n?(t&&(site.heartbeatSeconds=+t),clearTimeout(site.heartbeatTimeout),site.heartbeatTimeout=setTimeout(SendHeartbeat,1e3*site.heartbeatSeconds)):clearTimeout(site.heartbeatTimeout)}function SendHeartbeat(){if(site.heartbeatActive){var n={Status:$("#electionState").data("state"),Context:site.context,Stamp:site.lastVersionNum};CallAjaxHandler(GetRootUrl()+"Public/Heartbeat",n,ProcessPulseResult)}}function ProcessPulseResult(n){(ActivateHeartbeat(site.heartbeatActive),n)&&(n.NewStamp&&(site.lastVersionNum=n.NewStamp),site.computerActive=n.Active,n.Active?$(".Heartbeat").removeClass("Frozen").text("").effect("highlight","slow"):$(".Heartbeat").addClass("Frozen").text("Not Connected"),n.NewStatus&&site.broadcast(site.broadcastCode.electionStatusChanged,n.NewStatus),n.PulseSeconds&&(site.heartbeatSeconds=n.PulseSeconds),site.broadcast(site.broadcastCode.pulse,n))}function CallAjaxHandler(n,t,i,r,u,f){var e={type:"POST",url:n,traditional:!0,success:function(n){HasErrors(n)||(ResetStatusDisplay(),typeof i!="undefined"&&i(JsonParse(n),r))},error:function(n){typeof u!="undefined"?u(n):ShowStatusFailed(n)}};return t&&(e.data=t),f&&(e.async=!1),$.ajax(e)}function JsonParse(n){if(n=="")return null;if(typeof n!="string")return n;if(typeof JSON!="undefined"&&JSON)try{return JSON.parse(n)}catch(t){console.log(t);console.log(n);ShowStatusFailed(t.message)}try{return eval("("+n+")")}catch(t){console.log(t);console.log(n)}}function GetRootUrl(){return site.rootUrl}function PrepareStatusDisplay(){var n=$("body").hasClass("Public Index")?"body":"#body";$("body").prepend('<div class="StatusOuter"><div class="StatusMiddle"><div class="StatusInner"><div id="statusDisplay" class="StatusActive" style="display: none;"><\/div><\/div><\/div><\/div>')}function ShowStatusDisplay(n,t,i,r,u){var f,e,o;if(statusDisplay.minDisplayTimeBeforeStatusReset=i=typeof i=="number"?i:6e5,statusDisplay.minDisplayTimeBeforeStatusReset&&(clearTimeout(statusDisplay.resetTimer),statusDisplay.resetTimer=setTimeout(ResetStatusDisplay,statusDisplay.minDisplayTimeBeforeStatusReset),statusDisplay.minDisplayTimeBeforeStatusReset=0),typeof t!="number"&&(t=0),t>0){statusDisplay.delayedShowStatusArray[statusDisplay.delayedShowStatusArray.length]=setTimeout(function(){ShowStatusDisplay(n,0,i,r)},t);return}f=$("#statusDisplay2, #statusDisplay");f.length===0;e='<img class=ajaxIcon src="'+GetRootUrl()+'images/ajax-loader.gif"> ';o=r?'<span class="ui-icon ui-icon-alert"><\/span>':u?"":e;f.html(o+n).show();r?f.addClass("error"):f.removeClass("error")}function ShowStatusSuccess(n){ShowStatusDisplay(n,0,3e3,!1,!0)}function ShowStatusFailed(n,t){var f,r,i,u;if(ResetStatusDisplay(),f=0,r=!1,typeof t=="undefined"&&(t=6e5),typeof n=="string")i=n;else if(typeof n.statusText=="string")if(n.status===200||n.status===406)i=n.responseText;else if(n.status===0&&n.statusText=="error")i="Please wait...",ShowStatusDisplay(i,0,t,!1,!1),r=!0;else{if(n.status===503)return top.location.href=top.location.href,"";i="("+n.status+") "+n.statusText+": ";n.responseText&&(u=n.responseText.match(/\<title\>(.*?)\<\/title\>/i),i=u!==null?i+u[1]:i+n.responseText)}else i="Error";return r||(ResetStatusDisplay(),ShowStatusDisplay(i,f,t,!0)),i}function ResetStatusDisplay(){for(clearTimeout(statusDisplay.resetTimer);statusDisplay.delayedShowStatusArray.length;)clearTimeout(statusDisplay.delayedShowStatusArray[statusDisplay.delayedShowStatusArray.length-1]),statusDisplay.delayedShowStatusArray.length--;if(statusDisplay.minDisplayTimeBeforeStatusReset!==0){statusDisplay.resetTimer=setTimeout(ResetStatusDisplay,statusDisplay.minDisplayTimeBeforeStatusReset);statusDisplay.minDisplayTimeBeforeStatusReset=0;return}HideStatusDisplay()}function HideStatusDisplay(){$("#statusDisplay2, #statusDisplay").hide()}function alerts(){for(var i,r,t=[],n=0;n<arguments.length;n++){i=arguments[n];try{r=i===null?"null":typeof i=="undefined"?"undefined":arguments[n].toString();t[t.length]=n+1+": "+r}catch(u){t[t.length]=n+1+": "+u.name+" - "+u.message}}alert(t.join("\n"))}function comma(n,t,i,r){var a,s,f,l,u,e,o,v,h,c,y,p;if(n==0&&typeof r!="undefined"&&r!=null&&r!="")return r;if(a=n<0,n=Math.abs(n),n=+n,isNaN(n))return"Num?";if(s=site.languageCode=="FR",t==-1&&(t=Math.floor(n)==n?0:2),t==null&&(t=0),t>=0&&(n=n*Math.pow(10,t),n=Math.round(n),n=n/Math.pow(10,t)),f=Math.floor(n),l=n-f,f=""+f,f.length>3)for(o=f.length%3,v=Math.floor(f.length/3),u=o>0?f.substring(0,o):"",e=0;e<v;e++)u=o==0&&e==0?u+""+f.substring(o+3*e,o+3*e+3):u+(s?" ":",")+f.substring(o+3*e,o+3*e+3);else u=f;if(h=s?",":".",l!=""&&t!=0&&(u+=h+(Math.round(l*Math.pow(10,t))/Math.pow(10,t)).toString().substr(2)),t!=0)for(c=u.indexOf(h),y=u.length,c==-1&&(c=u.length-1,u+=h),p=Math.abs(y-c-1-t),e=0;e<p;e++)u+=0;return a&&(u="-"+u),i==="D"&&(u=s?u+" $":"$"+u),i==="P"&&(u=s?u+" %":u+"%"),u}function BrowserRemovesAttrQuotes(){return site.browserModelDetail==="IE8"}function getTemplate(n,t){var f=$(n),e=f.html(),i,r,u,o;if(!e)return"";i=BrowserRemovesAttrQuotes()?ieInnerHTML(f):e;r={"%7B":"{","%7D":"}"};$.extend(r,t);for(u in r)o=new RegExp(u,"g"),i=i.replace(o,r[u]);return i}function ieInnerHTML(n,t){var e=n.html(),r=e.match(/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/g),i,u,o,s,f,h,c,l;if(r)for(i=0;i<r.length;i++){if(o=r[i],s=/\=[a-zA-Z\.\:\[\]_\(\)\{\}\&\$\%#\@\!0-9]+[?\s+|?>]/g,r[i]=r[i].replace(/(<?\w+)|(<\/?\w+)\s/,function(n){return n.toLowerCase()}),u=r[i].match(s),u)for(f=0,h=u.length;f<h;)c=/(\=)([a-zA-Z\.\:\[\]_\(\{\}\)\&\$\%#\@\!0-9]+)?([\s+|?>])/g,l=function(){var n=Array.prototype.slice.call(arguments);return'="'+(t?n[2].toLowerCase():n[2])+'"'+n[3]},r[i]=r[i].replace(u[f],u[f].replace(c,l)),f++;e=e.replace(o,r[i])}return e}function CountOf(n,t){var i=n.match(t);return i?i.length:0}function GetValue(n){if(site.languageCode=="FR"?(n=n.replace(/\./g,""),n=n.replace(/,/g,".")):n=n.replace(/\,/g,""),CountOf(n,/\./g)>1)return NaN;n=n.replace(/\$/g,"");n=n.replace(/\%/g,"");n=n.replace(/[ \xA0]/g,"");return Number(n)}function FormatDate(n,t,i,r,u){var f,l,a;if((""+n).substring(0,5)=="/Date"&&(n=n.parseJsonDate()),n==null||isNaN(n)||n=="NaN"||n==="01/01/0001"||n==="")return"";if(f=new Date(n),isNaN(f))return"[Invalid Date]";u||(console.log("time offset {0}".filledWith(site.timeOffset)),console.log("  - original: {0}".filledWith(f.toString())),f=new Date(f.getTime()+site.timeOffset),console.log("  - after   : {0}".filledWith(f.toString())));t||(t="YYYY-MM-DD");var c="January February March April May June July August September October November December".split(" "),v="Sun Mon Tue Wed Thu Fri Sat".split(" "),o=f.getDate(),s=f.getMonth(),h=f.getFullYear(),y=f.getHours(),p=f.getMinutes(),e="";switch(t){case"MMM D, YYYY":e=c[s].substring(0,3)+" "+o+", "+h;break;case"D MMM YYYY":l=o+" "+c[s].substring(0,3)+" "+h;site.languageCode=="FR"&&i&&+o==1&&(l=l.replace("1","1<sup>{0}<\/sup>".filledWith("er")));e=l;break;case"DDD, D MMM YYYY":e=v[f.getDay()]+", "+o+" "+c[s].substring(0,3)+" "+h;break;case"YYYY-MM-DD":a=s+1;e=h+"-"+(a<10?"0":"")+a+"-"+(o<10?"0":"")+o;break;case"MMM YYYY":e=c[s].substring(0,3)+" "+h;break;case"MMMM YYYY":e=c[s]+" "+h;break;case"MM/DD/YYYY":var w=s+1,b=("0"+w).slice(-2),k=("0"+o).slice(-2);e=b+"/"+k+"/"+h;break;default:e=""}return r&&(e+=" {0}:{1}".filledWith(y.as2digitString(),p.as2digitString())),e}function StringifyObject(n){return JSON.stringify(n)}function Plural(n,t,i,r){return n===1?i||"":n===0?r||t||"s":t||"s"}function startTimer(){site.stTime=(new Date).getTime()}function endTimer(n){typeof site.stTime!="undefined"&&site.stTime&&console.log(n+" "+((new Date).getTime()-site.stTime))}function OptionsFromResourceList(n,t){var i=[];return $.each(n,function(n,r){i.push({Key:n,Text:r,Selected:t==n?" selected":""})}),'<option value="{Key}"{Selected}>{Text}<\/option>'.filledWithEach(i)}function GetFromStorage(n,t){var r=function(n){return n.substring(0,ObjectConstant.length)==ObjectConstant&&(n=JSON.parse(n.substring(ObjectConstant.length))),n},i=localStorage[n];return typeof i!="undefined"&&i!=null?r(i):t}function SetInStorage(n,t){if(!t){localStorage.removeItem(n);return}if(typeof t=="object"){var i=StringifyObject(t);t=ObjectConstant+i}return localStorage[n]=t,t}function ExpandName(n){for(var t,i=[],r=0,u=n.length;r<u;r++)t=n[r],t>="A"&&t<="Z"&&i.push(" "),i.push(t);return i.join("")}var site={onload:[],languageCode:"EN",templates:{},computerActive:!0,context:"",passcode:null,lastVersionNum:0,infoForHeartbeat:{},heartbeatActive:!0,heartbeatSeconds:60,heartbeatTimeout:null,timeOffsetKnown:!1,hoverQuickLinkRevertDelay:null,hoverQuickLinkShowDelay:null,firstPulse:null,electionGuid:null,electionState:null,signalrConnectionId:null,signalrConnecting:!1,signalrDelayedCallbacks:[],signalrDelay:null,signalrReconnecting:!1,menuShowingDefault:!0,menuShowDelay:1e3,menuResetDelay:2e3,qTips:[],broadcastCode:{electionStatusChanged:"electionStatusChanged",locationChanged:"locationChanged",startNewPerson:"startNewPerson",personSaved:"personSaved",personNameChanging:"personNameChanging",pulse:"pulse"},broadcast:function(n,t){$(document).triggerHandler(n,t)},onbroadcast:function(n,t,i){$(document).on(n,null,i,t)},timeOffset:0,rootUrl:"/"},storageKey={MonitorRefresh:"MonitorRefresh"},MyResources={},connectToElectionHub,startSignalR,quickDashCloser,setTopInfo,statusDisplay,ObjectConstant,adjustElection;$(function(){Onload()});connectToElectionHub=function(){var t=$.connection.mainHubCore,n;t.client.statusChanged=function(n){console.log("signalR: electionStatusChanged");site.broadcast(site.broadcastCode.electionStatusChanged,n)};n=!1;t.client.electionClosed=function(){console.log("signalR: electionClosed");n||(logoffSignalR(),location.href=site.rootUrl+"Account/Logoff",n=!0,alert("This election has been closed. Thank you for your participation!"))};startSignalR(function(){console.log("Joining main hub");CallAjaxHandler(site.rootUrl+"Public/JoinMainHub",{connId:site.signalrConnectionId,electionGuid:site.electionGuid})})};startSignalR=function(n){if($.connection.hub.id){console.log("WARNING: already connected");n();return}site.signalrDelayedCallbacks.push(n);clearTimeout(site.signalrDelay);site.signalrDelay=setTimeout(function(){$.connection.hub.error(function(n){var t=n.toString();console.log("error",n);t.indexOf("The client has been inactive since")!==-1?ShowStatusFailed("We've been disconnected from the server for too long.<br>Please refresh this page (press F5) to reconnect and continue."):t.indexOf("WebSocket closed")?ShowStatusDisplay("Disconnected from the server."):ShowStatusFailed(t)});$.connection.hub.start().done(function(){site.signalrConnectionId=$.connection.hub.id;for(var n=0;n<site.signalrDelayedCallbacks.length;n++)site.signalrDelayedCallbacks[n]()});site.signalrReconnecting=!1;$.connection.hub.connectionSlow(function(){console.log("slow");ShowStatusDisplay("The connection to the server is slow... please wait...")});$.connection.hub.reconnecting(function(){console.log("reconnecting");ShowStatusDisplay("Attempting to reconnect to the server...");site.signalrReconnecting=!0});$.connection.hub.reconnected(function(){console.log("connected");ShowStatusDisplay("Reconnected!",0,3e3,!1,!0);site.signalrReconnecting=!1});$.connection.hub.disconnected(function(){console.log("disconnected");site.signalrReconnecting&&ShowStatusFailed("We've been disconnected from the server for too long.<br>Please refresh this page (press F5) to reconnect and continue.")})},0)};quickDashCloser=function(n){console.log($(n.srcElement).closest(".QuickDash"));$(n.srcElement).closest(".QuickDash").length==0&&($(".QuickDash").fadeOut("fast"),$(".ElectionState .General").removeClass("GeneralActive"),$(document).off("click",quickDashCloser))};setTopInfo=function(){var n=$("#ddlTopLocation"),u=+n.val(),i=n.is(":visible")&&u===-1,t=$("#ddlTopTeller1"),r=t.is(":visible")&&t.val()<=0;$(".CurrentInfo").toggleClass("NotSet",i||r);n.toggleClass("NotSet",i);t.toggleClass("NotSet",r);$("#ddlTopTeller2").toggleClass("NotSet",+$("#ddlTopTeller2").val()<=0)};String.prototype.parseJsonDate=function(){if(this=="")return null;var n=/\((.+)\)/.exec(this)[1];return new Date(+n)};String.prototype.parseJsonDateForInput=function(){var n;if(this=="")return"";n=this.parseJsonDate();n.setTime(n.getTime()+n.getTimezoneOffset()*6e4);var t=("0"+n.getDate()).slice(-2),i=("0"+(n.getMonth()+1)).slice(-2);return n.getFullYear()+"-"+i+"-"+t};statusDisplay={minDisplayTimeBeforeStatusReset:0,resetTimer:null,delayedShowStatusArray:[]};Number.prototype.as2digitString=function(){return("00"+this).substr(-2)};String.prototype.filledWith=function(){var n=typeof arguments[0]=="object"&&arguments.length===1?arguments[0]:arguments;arguments.length==0&&arguments[0].length&&(n={},$.each(arguments[0],function(t,i){n[t]=i}));for(var u=/^#/,f=/^\^/,e=/{([^{]+?)}/g,i=function(t){return t.replace(e,function(){var r=arguments[1],i=undefined,e;try{n===null?i="":u.test(r)?i=eval(r.substring(1)):f.test(r)?i=n[r.substring(1)]:(e=n[r],i=typeof e=="undefined"||e===null?"":(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/{/g,"&#123;"))}catch(o){console.log("filledWithError:\n"+o+"\ntoken:"+r+"\nvalue:"+i+"\ntemplate:"+t);console.log(n);throw"Error in filledWith";}return typeof i=="undefined"||i==null?"":""+i})},t=i(this),r="";r!=t;)r=t,t=i(t);return t.replace(/&#123;/g,"{")};String.prototype.filledWithEach=function(n,t){var i,r,u;if(n===undefined||n===null)return"";for(t===undefined&&(t=""),i=[],r=0,u=n.length;r<u;r++)i[i.length]=this.filledWith(n[r]);return i.join(t)};ObjectConstant="$@$";adjustElection=function(n){return n};Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(n){var i,r,u,t,f;if(this==null)throw new TypeError('"this" is null or not defined');if(i=Object(this),r=i.length>>>0,typeof n!="function")throw new TypeError("predicate must be a function");for(u=arguments[1],t=0;t<r;){if(f=i[t],n.call(u,f,t,i))return t;t++}return-1}});